<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成功案例編輯器 - 包給力 Givespower.health</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <style>
        .editor-section { max-width: 700px; margin: 0 auto; }
        .field-hint { font-size: 0.875rem; color: #6c757d; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/">
            <img src="/img/logo/logo.png" alt="包給力 Givespower.health" style="max-height: 40px; margin-right: 10px;">
            <!-- 包給力 Givespower.health -->
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                
                
                
                <li class="nav-item">
                    <a class="nav-link " href="/">首頁</a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="nav-link " href="/about.html">關於我們</a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="nav-link " href="/programmes.html">課程介紹</a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="nav-link " href="/testimonials.html">成功案例</a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="nav-link " href="/blog.html">專業分享</a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="nav-link " href="/faq.html">常見問題</a>
                </li>
                
                
                
                <li class="nav-item">
                    <a class="nav-link btn btn-primary " href="/booking.html">預約體驗</a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>

<style>
/* Navbar: DMC 782 dark topaz toggler */
.navbar-toggler {
    border-color: var(--dmc-782-dark-topaz);
}

.navbar-toggler-icon {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' viewBox='0 0 30 30'%3e%3cpath stroke='%23AE7720' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
}

@media (max-width: 991px) {
    .navbar-collapse {
        padding-left: 20px;
        padding-right: 20px;
    }
    .navbar-nav {
        padding-left: 0 !important;
    }
    .navbar-nav .nav-item {
        padding-left: 0 !important;
        margin-left: 0 !important;
    }
    .navbar-nav .nav-link {
        padding-left: 0 !important;
        margin-left: 0 !important;
        text-align: left !important;
    }
    .navbar-nav .nav-link.btn-primary {
        margin: 10px 0 !important;
        margin-left: 0 !important;
        padding-left: 20px !important;
        padding-right: 20px !important;
        text-align: left !important;
        width: 100% !important;
    }
}
</style>


    <header class="page-header" style="padding: 100px 0 60px;">
        <div class="container text-center">
            <h1 style="font-size: 42px; font-weight: bold; margin-bottom: 15px;">成功案例編輯器</h1>
            <p class="lead" style="font-size: 18px;">填寫下方欄位後按「儲存」，會直接寫入專案並於下次建站後顯示於<a href="/testimonials.html">成功案例</a>。</p>
        </div>
    </header>

    <div class="container" style="padding: 40px 0 80px;">
        <div class="editor-section">
            <form id="testimonialForm" class="border rounded p-4 bg-light">
                <div class="form-group">
                    <label for="tName">客戶名稱 (name) *</label>
                    <input type="text" class="form-control" id="tName" required placeholder="例：32歲丁小姐 上班族">
                </div>
                <div class="form-group">
                    <label for="tCategory">類別 (category) *</label>
                    <input type="text" class="form-control" id="tCategory" required placeholder="例：減重成功、樂齡減重、體態改善">
                </div>
                <div class="form-group">
                    <label for="tContent">見證內容 (content) *</label>
                    <textarea class="form-control" id="tContent" rows="5" required placeholder="客戶的成功故事或心得"></textarea>
                </div>
                <div class="form-group">
                    <label for="tInstagram">Instagram 連結 (instagram)</label>
                    <input type="url" class="form-control" id="tInstagram" placeholder="https://www.instagram.com/givespower.health">
                    <small class="field-hint">選填，未填則使用預設 givespower.health</small>
                </div>
                <div class="form-group">
                    <label for="tImageFile">上傳客戶照片 (image)</label>
                    <input type="file" class="form-control-file" id="tImageFile" accept="image/jpeg,image/png,image/gif,image/webp">
                    <small class="field-hint">選填。會儲存為 <code>img/testimonials/<em>名稱</em>.jpg</code>。未上傳則使用 default.jpg。最大 4MB。</small>
                    <div id="tImagePreview" class="mt-2" style="display: none;"><img id="tImagePreviewImg" src="" alt="預覽" style="max-height: 120px; border-radius: 6px;"></div>
                </div>
                <div id="tFormAlert" class="alert mb-3" style="display: none;" role="alert"></div>
                <div class="form-group mb-0">
                    <button type="submit" class="btn btn-primary" id="tBtnSubmit">儲存成功案例</button>
                    <button type="button" class="btn btn-outline-secondary ml-2" id="tBtnReset">清空表單</button>
                </div>
            </form>
        </div>
    </div>

    <footer>
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h4>關於我們</h4>
                <p>包給力 Givespower.health 專注於提供專業的個人訓練服務，幫助您達成健康與健身目標。我們的專業教練團隊擁有豐富的經驗，為您量身打造最適合的訓練計劃。</p>
            </div>
            <div class="col-md-4">
                <h4>快速連結</h4>
                <ul class="list-unstyled">
                    <li><a href="/">首頁</a></li>
                    <li><a href="/about.html">關於我們</a></li>
                    <li><a href="/programmes.html">課程介紹</a></li>
                    <li><a href="/testimonials.html">成功案例</a></li>
                    <li><a href="/blog.html">專業分享</a></li>
                    <li><a href="/faq.html">常見問題</a></li>
                    <li><a href="/booking.html">預約體驗</a></li>
                </ul>
            </div>
            <div class="col-md-4">
                <h4>聯絡我們</h4>
                <p>
                    <strong>Line:</strong> <a href="https://lin.ee/Umt7lpD" target="_blank" rel="noopener noreferrer">@givespower.health</a><br>
                    <strong>Instagram:</strong> <a href="https://www.instagram.com/givespower.health" target="_blank" rel="noopener noreferrer">@givespower.health</a><br>
                    <strong>Email:</strong> givespower.health@gmail.com
                </p>
                <div class="social-links">
                    <a href="https://lin.ee/Umt7lpD" target="_blank" rel="noopener noreferrer" title="LINE">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.349 0-.63-.285-.63-.63V8.108c0-.345.281-.63.63-.63h2.386c.349 0 .63.285.63.63 0 .346-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.63-.631.63-.346 0-.63-.286-.63-.63V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.63-.63.63-.345 0-.63-.286-.63-.63V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.771zm-2.466.63H4.917c-.348 0-.63-.286-.63-.63V8.108c0-.345.282-.63.63-.63.349 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.039 1.085l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"/>
                        </svg>
                    </a>
                    <a href="https://www.instagram.com/givespower.health" target="_blank" rel="noopener noreferrer" title="Instagram">
                        <svg width="32" height="32" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        <hr>
        <div class="row text-center">
            <div class="col-md-12">
                <p>&copy; 2026 包給力 Givespower.health. All rights reserved.</p>
            </div>
        </div>
    </div>
</footer>

<style>
/* Footer: DMC palette */
footer {
    background-color: var(--dmc-413-dark-pewter-gray);
    color: var(--white);
    padding: 40px 0 20px;
}

footer a {
    color: var(--dmc-727-very-light-topaz);
    transition: color 0.3s ease;
}

footer a:hover {
    color: var(--dmc-742-light-tangerine);
}

footer h4 {
    color: var(--dmc-727-very-light-topaz);
    margin-bottom: 20px;
    font-weight: bold;
}

footer ul {
    list-style: none;
    padding: 0;
}

footer ul li {
    margin-bottom: 10px;
}

footer .social-links {
    margin-top: 20px;
}

footer .social-links a {
    display: inline-block;
    margin: 0 10px;
    color: var(--dmc-727-very-light-topaz);
    transition: transform 0.3s ease, color 0.3s ease;
}

footer .social-links a:hover {
    transform: translateY(-3px);
    color: var(--dmc-742-light-tangerine);
}

footer hr {
    border-color: rgba(255, 255, 255, 0.1);
    margin: 30px 0;
}

footer p {
    margin-bottom: 10px;
}
</style>


    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
(function() {
    var form = document.getElementById('testimonialForm');
    var formAlert = document.getElementById('tFormAlert');
    var btnSubmit = document.getElementById('tBtnSubmit');
    var tImageFile = document.getElementById('tImageFile');
    var tImagePreview = document.getElementById('tImagePreview');
    var tImagePreviewImg = document.getElementById('tImagePreviewImg');

    function showAlert(msg, isSuccess) {
        formAlert.textContent = msg;
        formAlert.className = 'alert mb-3 ' + (isSuccess ? 'alert-success' : 'alert-danger');
        formAlert.style.display = 'block';
    }
    function hideAlert() { formAlert.style.display = 'none'; }

    function readFileAsBase64(file) {
        return new Promise(function(resolve, reject) {
            var fr = new FileReader();
            fr.onload = function() {
                var data = fr.result;
                if (data.indexOf('base64,') >= 0) data = data.split('base64,')[1];
                resolve(data);
            };
            fr.onerror = reject;
            fr.readAsDataURL(file);
        });
    }

    form.addEventListener('submit', function(e) {
        e.preventDefault();
        hideAlert();
        var name = document.getElementById('tName').value.trim();
        var category = document.getElementById('tCategory').value.trim();
        var content = document.getElementById('tContent').value.trim();
        var instagram = document.getElementById('tInstagram').value.trim();
        if (!name || !category || !content) {
            showAlert('請填寫名稱、類別與見證內容。', false);
            return;
        }
        var payload = { name: name, category: category, content: content };
        if (instagram) payload.instagram = instagram;
        var file = tImageFile.files[0];
        if (file) {
            if (file.size > 4 * 1024 * 1024) {
                showAlert('圖片不得超過 4MB。', false);
                return;
            }
            readFileAsBase64(file).then(function(base64) {
                var ext = (file.name.split('.').pop() || 'jpg').toLowerCase();
                if (!/^(jpe?g|png|gif|webp)$/.test(ext)) ext = 'jpg';
                payload.image = { data: base64, extension: ext };
                doSave(payload);
            }).catch(function() { showAlert('無法讀取圖片，請重試。', false); });
        } else {
            doSave(payload);
        }
    });

    function doSave(payload) {
        btnSubmit.disabled = true;
        btnSubmit.textContent = '儲存中…';
        fetch('/api/save-testimonial', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        }).then(function(res) {
            return res.text().then(function(text) {
                var data;
                try { data = JSON.parse(text); } catch (e) {
                    if (text.trim().indexOf('<!') === 0 || text.trim().indexOf('<') === 0) {
                        showAlert('目前網址沒有提供 API。請用 vercel dev 在 http://localhost:3000 開啟本頁，或於正式站使用。', false);
                        return;
                    }
                    showAlert('伺服器回傳格式錯誤。', false);
                    return;
                }
                if (res.ok) {
                    formAlert.className = 'alert alert-success mb-3';
                    formAlert.innerHTML = (data.message || '成功案例已儲存。') + ' 請 <code>git pull</code> 後重建，或於 <a href="/testimonials.html">成功案例</a> 頁面查看。';
                    formAlert.style.display = 'block';
                } else {
                    showAlert(data.error || '儲存失敗。', false);
                }
            });
        }).catch(function(err) {
            showAlert('連線錯誤：' + (err.message || '請確認已用 vercel dev 或正式站。'), false);
        }).finally(function() {
            btnSubmit.disabled = false;
            btnSubmit.textContent = '儲存成功案例';
        });
    }

    document.getElementById('tBtnReset').addEventListener('click', function() {
        form.reset();
        tImageFile.value = '';
        tImagePreview.style.display = 'none';
        tImagePreviewImg.src = '';
        hideAlert();
    });

    tImageFile.addEventListener('change', function() {
        var file = this.files[0];
        if (!file) { tImagePreview.style.display = 'none'; tImagePreviewImg.src = ''; return; }
        tImagePreviewImg.src = URL.createObjectURL(file);
        tImagePreview.style.display = 'block';
    });
})();
    </script>
</body>
</html>
